# -------------------------
# APP
# -------------------------
server:
  port: 8080
  error:
    include-message: always
    include-binding-errors: always

# -------------------------
# METRICS
# -------------------------
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics
  endpoint:
    health:
      status:
        http-mapping:
          down: 500
      show-details: always
  httpexchanges:
    recording:
      include: request-headers,time-taken,session-id

# -------------------------
# SPRING CLOUD
# -------------------------
spring:
  application:
    name: bff-svc
  main:
    allow-bean-definition-overriding: true
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true
      routes:

        # ------------------------------------------------
        # ROUTE FOR GENERATE A CAPTCHA CODE.
        # ------------------------------------------------
        - id: captcha-generate
          uri: ${captcha-svc}
          predicates:
            - Path=/apigw/captcha/generate
          filters:
            - RewritePath=/apigw/(?<path>.*), /$\{path}

        # ------------------------------------------------
        # ROUTE FOR VALIDATE A CAPTCHA CODE.
        # ------------------------------------------------
        - id: captcha-validate
          uri: ${captcha-svc}
          predicates:
            - Path=/apigw/telefonica/v1/manage-auth-login/validate
          filters:
            - RewritePath=/apigw/(?<path>.*), /$\{path}

        # ------------------------------------------------
        # ROUTE FOR VALIDATE A USERNAME & PASSWORD.
        # ------------------------------------------------
        - id: ldap
          uri: ${ldap-svc}
          predicates:
            - Path=/apigw/telefonica/v1/manage-auth-login/ldap
          filters:
            - RewritePath=/apigw/(?<path>.*), /$\{path}

        # ------------------------------------------------
        # ROUTE TEST SERVICE MOCK DATA.
        # ------------------------------------------------
        - id: jsonplaceholder-comments
          uri: ${jsonplaceholder-svc}
          predicates:
            - Path=/apigw/**
          filters:
            - RewritePath=/apigw/(?<path>.*), /$\{path}

# ------------------
# CUSTOM HEADER
# ------------------
allowed:
  origin: https://datos-contacto.telefonicawebsites.co
